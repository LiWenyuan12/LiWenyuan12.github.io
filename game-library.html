<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>GameBox æ¸¸ç›’ - æ¸¸æˆåº“</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="index.css" />
  <!-- æ·»åŠ Google Fontsä»¥ä¼˜åŒ–å­—ä½“ -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700;900&display=swap" rel="stylesheet">
  
  <style>
    /* å…¨å±€å­—ä½“ä¼˜åŒ– */
    body {
      font-family: 'Noto Sans SC', -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }
    
    /* å®æ—¶æ•°æ®åŠ¨ç”» */
    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.8; transform: scale(1.05); }
    }
    
    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes shimmer {
      0% { background-position: -1000px 0; }
      100% { background-position: 1000px 0; }
    }
    
    /* æµå…‰ç‰¹æ•ˆåŠ¨ç”» */
    @keyframes flowingLight {
      0% {
        background-position: -200% center;
      }
      100% {
        background-position: 200% center;
      }
    }
    
    @keyframes glowPulse {
      0%, 100% {
        box-shadow: 0 0 20px rgba(56, 189, 248, 0.3),
                    0 0 40px rgba(56, 189, 248, 0.2),
                    0 0 60px rgba(56, 189, 248, 0.1);
      }
      50% {
        box-shadow: 0 0 30px rgba(56, 189, 248, 0.5),
                    0 0 60px rgba(56, 189, 248, 0.3),
                    0 0 90px rgba(56, 189, 248, 0.2);
      }
    }
    
    /* ç½‘æ ¼å¸ƒå±€ - æ¯è¡Œ2ä¸ªæ¸¸æˆ */
    .game-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 32px;
      padding: 40px 20px;
      max-width: 1600px;
      margin: 0 auto;
    }
    
    @media (max-width: 1400px) {
      .game-grid {
        grid-template-columns: 1fr;
        gap: 24px;
        max-width: 800px;
      }
      
      .game-card-header {
        height: 360px;
      }
    }
    
    /* æ¸¸æˆå¡ç‰‡ä¼˜åŒ– */
    .game-card {
      position: relative;
      background: linear-gradient(135deg, 
        rgba(15, 23, 42, 0.98) 0%, 
        rgba(15, 23, 42, 0.95) 100%);
      border-radius: 16px;
      border: 1px solid rgba(56, 189, 248, 0.2);
      padding: 0;
      overflow: hidden;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      animation: slideInUp 0.6s ease-out;
      cursor: pointer;
      min-height: 720px;
      display: flex;
      flex-direction: column;
    }
    
    /* æµå…‰è¾¹æ¡†æ•ˆæœ */
    .game-card::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(56, 189, 248, 0.8),
        rgba(139, 92, 246, 0.8),
        rgba(236, 72, 153, 0.8),
        transparent
      );
      background-size: 200% 100%;
      border-radius: 16px;
      opacity: 0;
      z-index: -1;
      animation: flowingLight 3s linear infinite;
      transition: opacity 0.4s;
    }
    
    .game-card:hover::before {
      opacity: 1;
    }
    
    /* æµå…‰å†…å‘å…‰ */
    .game-card::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(56, 189, 248, 0.15),
        transparent
      );
      transition: left 0.7s;
    }
    
    .game-card:hover::after {
      left: 100%;
    }
    
    .game-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4),
                  0 0 60px rgba(56, 189, 248, 0.3);
      border-color: rgba(56, 189, 248, 0.6);
    }
    
    /* æ¸¸æˆå°é¢åŒºåŸŸ */
    .game-card-header {
      position: relative;
      height: 340px;
      overflow: hidden;
      border-radius: 16px 16px 0 0;
    }
    
    .game-card-cover {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
      filter: brightness(0.9);
    }
    
    .game-card:hover .game-card-cover {
      transform: scale(1.15);
      filter: brightness(1.1);
    }
    
    /* æ¸å˜é®ç½© */
    .game-card-header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 60%;
      background: linear-gradient(to top, 
        rgba(15, 23, 42, 0.95) 0%,
        rgba(15, 23, 42, 0.6) 50%,
        transparent 100%);
      pointer-events: none;
    }
    
    /* æŠ˜æ‰£æ ‡ç­¾ */
    .discount-badge {
      position: absolute;
      top: 12px;
      right: 12px;
      padding: 6px 12px;
      border-radius: 8px;
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      color: white;
      font-weight: 900;
      font-size: 16px;
      box-shadow: 0 4px 15px rgba(239, 68, 68, 0.6);
      z-index: 2;
      animation: pulse 2s infinite;
      letter-spacing: 0.5px;
    }
    
    /* è¯„åˆ†å¾½ç«  */
    .rating-badge {
      position: absolute;
      top: 12px;
      left: 12px;
      padding: 6px 12px;
      border-radius: 8px;
      background: linear-gradient(135deg, rgba(234, 179, 8, 0.95) 0%, rgba(202, 138, 4, 0.95) 100%);
      color: #fff;
      font-weight: 900;
      font-size: 16px;
      box-shadow: 0 4px 15px rgba(234, 179, 8, 0.5);
      z-index: 2;
      display: flex;
      align-items: center;
      gap: 4px;
      letter-spacing: 0.5px;
    }
    
    /* å¡ç‰‡å†…å®¹ */
    .game-card-body {
      padding: 24px;
      position: relative;
      z-index: 1;
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    
    .game-title {
      font-size: 20px;
      font-weight: 900;
      color: #e0f2fe;
      margin-bottom: 8px;
      line-height: 1.3;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
      letter-spacing: 0.3px;
    }
    
    .game-description {
      font-size: 14px;
      color: #cbd5e1;
      margin-bottom: 12px;
      line-height: 1.6;
      min-height: 44px;
      max-height: 66px;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      font-weight: 500;
    }
    
    /* æ¸¸æˆæ ‡ç­¾ */
    .game-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 12px;
    }
    
    .game-tag {
      padding: 4px 10px;
      border-radius: 6px;
      background: rgba(56, 189, 248, 0.15);
      border: 1px solid rgba(56, 189, 248, 0.3);
      color: #7dd3fc;
      font-size: 12px;
      font-weight: 600;
      transition: all 0.3s;
      letter-spacing: 0.3px;
    }
    
    .game-tag:hover {
      background: rgba(56, 189, 248, 0.25);
      border-color: rgba(56, 189, 248, 0.5);
      transform: translateY(-2px);
    }
    
    /* ç»Ÿè®¡æ•°æ® */
    .game-stats {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
      margin-bottom: 12px;
      margin-top: auto;
    }
    
    .stat-item {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 4px;
      padding: 10px 14px;
      border-radius: 8px;
      background: rgba(15, 23, 42, 0.8);
      border: 1px solid rgba(56, 189, 248, 0.2);
      font-size: 13px;
      font-weight: 700;
      letter-spacing: 0.3px;
      min-height: 65px;
    }
    
    .stat-icon {
      font-size: 18px;
      margin-bottom: 2px;
    }
    
    .stat-value {
      color: #7dd3fc;
      font-weight: 900;
      font-size: 16px;
      line-height: 1.2;
    }
    
    .stat-label {
      color: #94a3b8;
      font-size: 11px;
      font-weight: 600;
      margin-top: 2px;
    }
    
    /* ä»·æ ¼æ˜¾ç¤º */
    .game-price {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px;
      border-radius: 10px;
      background: linear-gradient(135deg, 
        rgba(56, 189, 248, 0.1) 0%, 
        rgba(56, 189, 248, 0.05) 100%);
      border: 1px solid rgba(56, 189, 248, 0.3);
      margin-top: 8px;
    }
    
    .price-original {
      text-decoration: line-through;
      color: #64748b;
      font-size: 14px;
      font-weight: 600;
    }
    
    .price-current {
      color: #10b981;
      font-size: 24px;
      font-weight: 900;
      text-shadow: 0 2px 8px rgba(16, 185, 129, 0.5);
      letter-spacing: 0.5px;
    }
    
    .price-free {
      color: #10b981;
      font-size: 20px;
      font-weight: 900;
      text-shadow: 0 2px 8px rgba(16, 185, 129, 0.5);
      letter-spacing: 0.5px;
    }
    
    /* è¶‹åŠ¿æŒ‡ç¤ºå™¨ */
    .trending-hot {
      color: #ef4444;
      font-size: 20px;
      animation: pulse 1.5s infinite;
      filter: drop-shadow(0 0 8px rgba(239, 68, 68, 0.8));
    }
    
    .trending-up {
      color: #10b981;
      font-size: 18px;
      filter: drop-shadow(0 0 6px rgba(16, 185, 129, 0.6));
    }
    
    .trending-down {
      color: #f59e0b;
      font-size: 18px;
      filter: drop-shadow(0 0 6px rgba(245, 158, 11, 0.6));
    }
    
    .trending-stable {
      color: #6b7280;
      font-size: 18px;
    }
    
    /* å®æ—¶æ•°æ®å¾½ç«  */
    .live-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 12px;
      border-radius: 999px;
      font-size: 13px;
      font-weight: 900;
      background: linear-gradient(135deg, #10b981, #059669);
      color: white;
      animation: pulse 2s infinite;
      box-shadow: 0 0 20px rgba(16, 185, 129, 0.6);
      letter-spacing: 0.5px;
    }
    
    .live-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: white;
      animation: pulse 1.5s infinite;
      box-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
    }
    
    /* ç­›é€‰æ ä¼˜åŒ– */
    .filter-section {
      background: linear-gradient(135deg, 
        rgba(15, 23, 42, 0.98) 0%, 
        rgba(15, 23, 42, 0.95) 100%);
      border: 1px solid rgba(56, 189, 248, 0.3);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
      position: relative;
      overflow: hidden;
    }
    
    .filter-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(56, 189, 248, 0.1),
        transparent
      );
      animation: flowingLight 4s linear infinite;
    }
    
    /* æ’åºæŒ‰é’®ä¼˜åŒ– */
    .sort-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .sort-btn {
      padding: 10px 18px;
      border-radius: 10px;
      border: 1px solid rgba(56, 189, 248, 0.3);
      background: rgba(15, 23, 42, 0.9);
      color: #94a3b8;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      letter-spacing: 0.3px;
    }
    
    .sort-btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(56, 189, 248, 0.3);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }
    
    .sort-btn:hover::before {
      width: 300px;
      height: 300px;
    }
    
    .sort-btn:hover {
      border-color: rgba(56, 189, 248, 0.6);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(56, 189, 248, 0.3);
    }
    
    .sort-btn.active {
      background: linear-gradient(135deg, 
        rgba(56, 189, 248, 0.3) 0%, 
        rgba(56, 189, 248, 0.2) 100%);
      border-color: rgba(56, 189, 248, 0.8);
      color: #e0f2fe;
      box-shadow: 0 0 30px rgba(56, 189, 248, 0.4);
      animation: glowPulse 3s ease-in-out infinite;
    }
    
    .sort-btn.active span {
      position: relative;
      z-index: 1;
    }
    
    /* ç»Ÿè®¡é¢æ¿ä¼˜åŒ– */
    .stats-panel {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 12px;
      margin-top: 12px;
    }
    
    .stat-card {
      padding: 16px;
      border-radius: 12px;
      background: linear-gradient(135deg, 
        rgba(56, 189, 248, 0.12) 0%, 
        rgba(15, 23, 42, 0.9) 100%);
      border: 1px solid rgba(56, 189, 248, 0.3);
      text-align: center;
      position: relative;
      overflow: hidden;
      transition: all 0.3s;
    }
    
    .stat-card::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(
        45deg,
        transparent 30%,
        rgba(56, 189, 248, 0.1) 50%,
        transparent 70%
      );
      animation: flowingLight 5s linear infinite;
    }
    
    .stat-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 30px rgba(56, 189, 248, 0.3);
      border-color: rgba(56, 189, 248, 0.6);
    }
    
    .stat-card-label {
      font-size: 12px;
      color: #94a3b8;
      margin-bottom: 6px;
      font-weight: 700;
      position: relative;
      z-index: 1;
      letter-spacing: 0.5px;
    }
    
    .stat-card-value {
      font-size: 24px;
      font-weight: 900;
      color: #e0f2fe;
      text-shadow: 0 2px 8px rgba(56, 189, 248, 0.6);
      position: relative;
      z-index: 1;
      letter-spacing: 0.5px;
    }
    
    /* ç©ºçŠ¶æ€ä¼˜åŒ– */
    .empty-state {
      text-align: center;
      padding: 80px 20px;
      color: #6b7280;
    }
    
    .empty-icon {
      font-size: 80px;
      margin-bottom: 20px;
      opacity: 0.6;
      animation: pulse 2s infinite;
    }
    
    .empty-text {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 10px;
      letter-spacing: 0.5px;
    }
    
    .empty-hint {
      font-size: 16px;
      color: #9ca3af;
      font-weight: 500;
    }
    
    /* è¾“å…¥æ¡†ä¼˜åŒ– */
    input[type="text"],
    select {
      font-family: 'Noto Sans SC', sans-serif !important;
      font-weight: 600 !important;
      font-size: 14px !important;
      letter-spacing: 0.3px !important;
    }
    
    /* åŠ è½½éª¨æ¶å± */
    .skeleton {
      background: linear-gradient(90deg, 
        rgba(15, 23, 42, 0.9) 25%, 
        rgba(56, 189, 248, 0.15) 50%, 
        rgba(15, 23, 42, 0.9) 75%
      );
      background-size: 200% 100%;
      animation: shimmer 1.5s infinite;
      border-radius: 16px;
      height: 400px;
    }
    
    /* æ»šåŠ¨æ¡ç¾åŒ– */
    ::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }
    
    ::-webkit-scrollbar-track {
      background: rgba(15, 23, 42, 0.5);
    }
    
    ::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, #38bdf8, #8b5cf6);
      border-radius: 5px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(135deg, #0ea5e9, #7c3aed);
    }
  </style>
</head>
<body data-current-page="library">
<div class="page">
  <header class="header">
    <div class="header-inner">
      <a href="index.html" class="logo">
        <div class="logo-mark">G</div>
        <div>
          <div>GameBox æ¸¸ç›’</div>
          <div class="logo-sub">LIGHTWEIGHT GAME HUB</div>
        </div>
      </a>

      <nav class="nav-main">
        <a href="index.html" data-page="home" class="nav-link">é¦–é¡µ</a>
        <a href="news-list.html" data-page="news" class="nav-link">èµ„è®¯</a>
        <a href="game-library.html" data-page="library" class="nav-link">æ¸¸æˆåº“</a>
        <a href="ranking.html" data-page="ranking" class="nav-link">
          æ’è¡Œæ¦œ <span class="badge">HOT</span>
        </a>
        <a href="discount.html" data-page="discount" class="nav-link">æŠ˜æ‰£ / å²ä½</a>
        <a href="community.html" data-page="community" class="nav-link">ç¤¾åŒº</a>
        <a href="my-library.html" data-page="my" class="nav-link">æˆ‘çš„æ¸¸æˆ</a>
        <a href="tools.html" data-page="tools" class="nav-link">å·¥å…·ä¸­å¿ƒ</a>
        <a href="profile.html" data-page="profile" class="nav-link">ç”¨æˆ·ä¸­å¿ƒ</a>
      </nav>

      <div class="header-right">
        <div class="header-search">
          <input type="text" placeholder="æœç´¢æ¸¸æˆ / èµ„è®¯ / å¸–å­" />
          <span class="header-search-icon">ğŸ”</span>
        </div>
        <button class="header-user">æœªç™»å½• Â· æ¸¸å®¢</button>
      </div>
    </div>
  </header>

  <main class="main">
    <section>
      <div class="card">
        <div class="page-title">ğŸ® æ¸¸æˆåº“</div>
        <div class="page-intro">
          æµè§ˆ 80+ æ¬¾ç²¾é€‰æ¸¸æˆï¼Œé€šè¿‡åç§°ã€ç±»å‹ã€ä»·æ ¼ç­›é€‰ä½ æ„Ÿå…´è¶£çš„æ¸¸æˆï¼ŒæŸ¥çœ‹å®æ—¶åœ¨çº¿ç©å®¶æ•°å’Œæ¸¸æˆçƒ­åº¦ã€‚
        </div>
      </div>

      <div class="card filter-section">
        <header class="card-header">
          <div class="card-title">
            <span class="dot"></span>
            <span>ç­›é€‰ä¸æ’åº</span>
          </div>
          <div class="live-badge">
            <span class="live-dot"></span>
            å®æ—¶æ•°æ®
          </div>
        </header>

        <div class="form">
          <div class="form-row">
            <label for="libSearch">ğŸ” æŒ‰åç§°æœç´¢</label>
            <input type="text" id="libSearch" placeholder="è¾“å…¥æ¸¸æˆåï¼Œå¦‚ï¼šåŸç¥ã€é»‘ç¥è¯ã€è‰¾å°”ç™»æ³•ç¯..." />
          </div>

          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
            <div class="form-row">
              <label for="libType">ğŸ¯ æ¸¸æˆç±»å‹</label>
              <select id="libType">
                <option value="all">å…¨éƒ¨ç±»å‹</option>
                <option value="å¼€æ”¾ä¸–ç•Œ">å¼€æ”¾ä¸–ç•Œ</option>
                <option value="åŠ¨ä½œ">åŠ¨ä½œ</option>
                <option value="é­‚ç±»">é­‚ç±»</option>
                <option value="å›åˆåˆ¶RPG">å›åˆåˆ¶RPG</option>
                <option value="æ¨¡æ‹Ÿç»è¥">æ¨¡æ‹Ÿç»è¥</option>
                <option value="æ²™ç›’">æ²™ç›’</option>
                <option value="Roguelike">Roguelike</option>
                <option value="ç”Ÿå­˜">ç”Ÿå­˜</option>
                <option value="ç«æŠ€å°„å‡»">ç«æŠ€å°„å‡»</option>
                <option value="åˆä½œå°„å‡»">åˆä½œå°„å‡»</option>
                <option value="ARPG">ARPG</option>
                <option value="ç­–ç•¥">ç­–ç•¥</option>
              </select>
            </div>

            <div class="form-row">
              <label for="libPrice">ğŸ’° ä»·æ ¼åŒºé—´</label>
              <select id="libPrice">
                <option value="all">å…¨éƒ¨</option>
                <option value="free">å…è´¹ / F2P</option>
                <option value="low">50 å…ƒä»¥ä¸‹</option>
                <option value="mid">50-200 å…ƒ</option>
                <option value="high">200 å…ƒä»¥ä¸Š</option>
              </select>
            </div>
          </div>

          <div class="form-row">
            <label>ğŸ”¥ æ’åºæ–¹å¼</label>
            <div class="sort-buttons">
              <button class="sort-btn active" data-sort="hot"><span>ğŸ”¥ çƒ­åº¦æ’è¡Œ</span></button>
              <button class="sort-btn" data-sort="rating"><span>â­ è¯„åˆ†æœ€é«˜</span></button>
              <button class="sort-btn" data-sort="online"><span>ğŸ‘¥ åœ¨çº¿äººæ•°</span></button>
              <button class="sort-btn" data-sort="discount"><span>ğŸ’° æŠ˜æ‰£åŠ›åº¦</span></button>
              <button class="sort-btn" data-sort="new"><span>ğŸ†• æœ€æ–°ä¸Šæ¶</span></button>
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <header class="card-header">
          <div class="card-title">
            <span class="dot"></span>
            <span>ç­›é€‰ç»“æœ</span>
          </div>
          <div style="display: flex; gap: 8px; align-items: center;">
            <div class="chip" id="libResultCount">å…± 0 æ¬¾</div>
          </div>
        </header>
        <div id="libList" class="game-grid">
          <!-- éª¨æ¶å± -->
          <div class="skeleton"></div>
          <div class="skeleton"></div>
          <div class="skeleton"></div>
        </div>
      </div>
    </section>

    <aside>
      <div class="sidebar-card">
        <div class="sidebar-title">ğŸ“Š å®æ—¶ç»Ÿè®¡</div>
        
        <div class="stats-panel">
          <div class="stat-card">
            <div class="stat-card-label">æ€»åœ¨çº¿ç©å®¶</div>
            <div class="stat-card-value" id="totalOnline">-</div>
          </div>
          <div class="stat-card">
            <div class="stat-card-label">æŠ˜æ‰£æ¸¸æˆ</div>
            <div class="stat-card-value" id="discountCount">-</div>
          </div>
          <div class="stat-card">
            <div class="stat-card-label">å¹³å‡è¯„åˆ†</div>
            <div class="stat-card-value" id="avgRating">-</div>
          </div>
          <div class="stat-card">
            <div class="stat-card-label">æ¸¸æˆæ€»æ•°</div>
            <div class="stat-card-value" id="totalGames">-</div>
          </div>
        </div>
        
        <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid rgba(56, 189, 248, 0.2);">
          <div class="sidebar-item">
            <span class="label">æ›´æ–°é¢‘ç‡</span>
            <span class="value">æ¯ 30 ç§’</span>
          </div>
          <div class="sidebar-item">
            <span class="label">æ•°æ®æ¥æº</span>
            <span class="value">æ¨¡æ‹Ÿå®æ—¶</span>
          </div>
          <div class="sidebar-item">
            <span class="label">ä¸Šæ¬¡æ›´æ–°</span>
            <span class="value" id="lastUpdate">-</span>
          </div>
        </div>
      </div>

      <div class="sidebar-card" style="margin-top: 16px;">
        <div class="sidebar-title">ğŸ”¥ çƒ­é—¨æ ‡ç­¾</div>
        <div style="display: flex; flex-wrap: wrap; gap: 6px; margin-top: 8px;">
          <span class="pill" style="cursor: pointer;" data-type="å¼€æ”¾ä¸–ç•Œ">å¼€æ”¾ä¸–ç•Œ</span>
          <span class="pill pill-soft" style="cursor: pointer;" data-type="åŠ¨ä½œ">åŠ¨ä½œ</span>
          <span class="pill pill-soft" style="cursor: pointer;" data-type="æ²™ç›’">æ²™ç›’</span>
          <span class="pill pill-soft" style="cursor: pointer;" data-type="ç«æŠ€å°„å‡»">ç«æŠ€å°„å‡»</span>
          <span class="pill pill-soft" style="cursor: pointer;" data-type="Roguelike">Roguelike</span>
          <span class="pill pill-soft" style="cursor: pointer;" data-type="ARPG">ARPG</span>
        </div>
      </div>
    </aside>
  </main>
</div>

<script src="common.js"></script>
<script>
  initCommon();

  let gameData = [];
  let filteredData = [];
  let updateInterval = null;
  let currentSort = 'hot';

  const libSearch = document.getElementById("libSearch");
  const libType = document.getElementById("libType");
  const libPrice = document.getElementById("libPrice");
  const libList = document.getElementById("libList");
  const libResultCount = document.getElementById("libResultCount");
  const totalOnline = document.getElementById("totalOnline");
  const discountCount = document.getElementById("discountCount");
  const avgRating = document.getElementById("avgRating");
  const totalGames = document.getElementById("totalGames");
  const lastUpdate = document.getElementById("lastUpdate");

  // æ ¼å¼åŒ–æ•°å­—
  function formatNumber(num) {
    if (!num) return '0';
    if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
    if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
    return num.toLocaleString();
  }

  // è·å–è¶‹åŠ¿å›¾æ ‡
  function getTrendingIcon(trending) {
    const icons = {
      'hot': '<span class="trending-hot">ğŸ”¥</span>',
      'up': '<span class="trending-up">ğŸ“ˆ</span>',
      'down': '<span class="trending-down">ğŸ“‰</span>',
      'stable': '<span class="trending-stable">â–</span>'
    };
    return icons[trending] || '';
  }

  // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
  function updateStats() {
    const total = gameData.reduce((sum, g) => sum + (g.onlinePlayers || 0), 0);
    const discounts = gameData.filter(g => g.discount && g.discount > 0).length;
    const avgScore = (gameData.reduce((sum, g) => sum + g.rating, 0) / gameData.length).toFixed(1);
    
    if (totalOnline) totalOnline.textContent = formatNumber(total);
    if (discountCount) discountCount.textContent = discounts;
    if (avgRating) avgRating.textContent = avgScore;
    if (totalGames) totalGames.textContent = gameData.length;
    if (lastUpdate) {
      const now = new Date();
      lastUpdate.textContent = now.toLocaleTimeString('zh-CN');
    }
  }

  // ç­›é€‰æ•°æ®
  function filterData() {
    let filtered = [...gameData];

    // å…³é”®è¯æœç´¢
    const kw = libSearch.value.trim().toLowerCase();
    if (kw) {
      filtered = filtered.filter(g =>
        g.name.toLowerCase().includes(kw) || 
        g.description.toLowerCase().includes(kw) ||
        (g.tags && g.tags.some(tag => tag.toLowerCase().includes(kw)))
      );
    }

    // ç±»å‹ç­›é€‰
    if (libType.value !== "all") {
      filtered = filtered.filter(g => g.type === libType.value);
    }

    // ä»·æ ¼ç­›é€‰
    if (libPrice.value === "free") {
      filtered = filtered.filter(g => g.priceNow === 0);
    } else if (libPrice.value === "low") {
      filtered = filtered.filter(g => g.priceNow > 0 && g.priceNow < 50);
    } else if (libPrice.value === "mid") {
      filtered = filtered.filter(g => g.priceNow >= 50 && g.priceNow <= 200);
    } else if (libPrice.value === "high") {
      filtered = filtered.filter(g => g.priceNow > 200);
    }

    // æ’åº
    switch (currentSort) {
      case 'hot':
        filtered.sort((a, b) => b.hotness - a.hotness);
        break;
      case 'rating':
        filtered.sort((a, b) => b.rating - a.rating);
        break;
      case 'online':
        filtered.sort((a, b) => (b.onlinePlayers || 0) - (a.onlinePlayers || 0));
        break;
      case 'discount':
        filtered.sort((a, b) => (b.discount || 0) - (a.discount || 0));
        break;
      case 'new':
        filtered.sort((a, b) => b.id - a.id);
        break;
    }

    filteredData = filtered;
    return filtered;
  }

  // æ¸²æŸ“æ¸¸æˆåˆ—è¡¨
  function renderList() {
    const filtered = filterData();
    
    libResultCount.textContent = `å…± ${filtered.length} æ¬¾`;
    libList.innerHTML = "";

    if (filtered.length === 0) {
      libList.innerHTML = `
        <div class="empty-state" style="grid-column: 1 / -1;">
          <div class="empty-icon">ğŸ®</div>
          <div class="empty-text">æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„æ¸¸æˆ</div>
          <div class="empty-hint">è¯•è¯•è°ƒæ•´ç­›é€‰æ¡ä»¶æˆ–æœç´¢å…³é”®è¯</div>
        </div>
      `;
      return;
    }

    filtered.forEach((game, index) => {
      const card = document.createElement("div");
      card.className = "game-card";
      card.style.animationDelay = `${(index % 12) * 0.05}s`;

      // æ ‡ç­¾HTML
      const tagsHTML = game.tags ? game.tags.slice(0, 3).map(tag => 
        `<span class="game-tag">${tag}</span>`
      ).join('') : '';

      // ç»Ÿè®¡æ•°æ®HTML
      const statsHTML = game.onlinePlayers !== undefined ? `
        <div class="game-stats">
          <div class="stat-item">
            <span class="stat-icon">ğŸ‘¥</span>
            <div>
              <div class="stat-value">${formatNumber(game.onlinePlayers)}</div>
              <div class="stat-label">åœ¨çº¿</div>
            </div>
          </div>
          <div class="stat-item">
            <span class="stat-icon">ğŸ“Š</span>
            <div>
              <div class="stat-value">${formatNumber(game.peakPlayers)}</div>
              <div class="stat-label">å³°å€¼</div>
            </div>
          </div>
        </div>
      ` : '';

      // ä»·æ ¼HTML
      let priceHTML = '';
      if (game.discount > 0) {
        priceHTML = `
          <div class="game-price">
            <div>
              <div class="price-original">Â¥${game.priceOriginal}</div>
              <div class="price-current">Â¥${game.priceNow}</div>
            </div>
            ${getTrendingIcon(game.trending)}
          </div>
        `;
      } else if (game.priceNow > 0) {
        priceHTML = `
          <div class="game-price">
            <div class="price-current">Â¥${game.priceNow}</div>
            ${getTrendingIcon(game.trending)}
          </div>
        `;
      } else {
        priceHTML = `
          <div class="game-price">
            <div class="price-free">å…è´¹æ¸¸ç©</div>
            ${getTrendingIcon(game.trending)}
          </div>
        `;
      }

      card.innerHTML = `
        <div class="game-card-header">
          <img class="game-card-cover" src="${game.cover}" alt="${game.name}" onerror="this.src='https://via.placeholder.com/400x225/0f172a/38bdf8?text=${encodeURIComponent(game.name)}'">
          ${game.discount > 0 ? `<div class="discount-badge">-${game.discount}%</div>` : ''}
          <div class="rating-badge">â­ ${game.rating}</div>
        </div>
        <div class="game-card-body">
          <h3 class="game-title">${game.name}</h3>
          <p class="game-description">${game.description}</p>
          <div class="game-tags">
            ${tagsHTML}
          </div>
          ${statsHTML}
          ${priceHTML}
        </div>
      `;

      libList.appendChild(card);
    });
  }

  // æ¨¡æ‹Ÿå®æ—¶æ•°æ®æ›´æ–°
  function simulateLiveUpdate() {
    gameData.forEach(game => {
      if (game.onlinePlayers !== undefined) {
        // åœ¨çº¿ç©å®¶æ•°éšæœºæ³¢åŠ¨ Â±3%
        const change = game.onlinePlayers * 0.03 * (Math.random() - 0.5);
        game.onlinePlayers = Math.max(0, Math.round(game.onlinePlayers + change));
        
        // éšæœºæ›´æ–°è¶‹åŠ¿
        const rand = Math.random();
        if (rand > 0.97) {
          game.trending = 'hot';
        } else if (rand > 0.75) {
          game.trending = 'up';
        } else if (rand > 0.6) {
          game.trending = 'down';
        } else {
          game.trending = 'stable';
        }
      }
    });
    
    renderList();
    updateStats();
  }

  // æ’åºæŒ‰é’®äº‹ä»¶
  document.querySelectorAll('.sort-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelector('.sort-btn.active')?.classList.remove('active');
      btn.classList.add('active');
      currentSort = btn.dataset.sort;
      renderList();
    });
  });

  // å¿«é€Ÿæ ‡ç­¾ç­›é€‰
  document.querySelectorAll('[data-type]').forEach(tag => {
    tag.addEventListener('click', () => {
      libType.value = tag.dataset.type;
      renderList();
    });
  });

  // åŠ è½½æ¸¸æˆæ•°æ®
  fetch("games-library.json")
    .then(res => res.json())
    .then(data => {
      gameData = data;
      renderList();
      updateStats();
      
      // å¯åŠ¨å®šæ—¶æ›´æ–°ï¼ˆ30ç§’ï¼‰
      if (updateInterval) clearInterval(updateInterval);
      updateInterval = setInterval(simulateLiveUpdate, 30000);
    })
    .catch(err => {
      console.error(err);
      libList.innerHTML = `
        <div class="empty-state" style="grid-column: 1 / -1;">
          <div class="empty-icon">âŒ</div>
          <div class="empty-text" style="color: #ef4444;">åŠ è½½å¤±è´¥</div>
          <div class="empty-hint">æ‰¾ä¸åˆ° games-library.json</div>
        </div>
      `;
    });

  // ç­›é€‰äº‹ä»¶
  libSearch.addEventListener("input", renderList);
  libType.addEventListener("change", renderList);
  libPrice.addEventListener("change", renderList);

  // æ¸…ç†å®šæ—¶å™¨
  window.addEventListener('beforeunload', () => {
    if (updateInterval) clearInterval(updateInterval);
  });
</script>
</body>
</html>
